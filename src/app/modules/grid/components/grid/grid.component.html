<igx-grid #grid
          [isLoading]="isLoading"
          [data]="data"
          [primaryKey]="primaryKey"
          [locale]="'ja-JP'"
          [displayDensity]="'compact'"
          [allowFiltering]="true"
          [filterMode]="'excelStyleFilter'"
          [rowSelectable]="true"
          [showToolbar]="true"
          [toolbarTitle]="toolbarTitle"
          [exportText]="'エクスポート'"
          [exportExcel]="true"
          [exportExcelText]="'Excel'"
          [exportCsv]="true"
          [exportCsvText]="'CSV'"
          (onToolbarExporting)="onToolbarExporting($event)"
          (onDoubleClick)="onDoubleClick($event)"

          appCopy

          appPaste
          (pasteData)="onPasteData($event)"

          appUndoRedo
          (undo)="onUndo()"
          (redo)="onRedo()"

          appRangeRowSelection>
  <ng-template igxToolbarCustomContent let-igxGrid="grid">
    <input #inputFile
           type="file"
           [accept]="acceptExtension"
           style="display: none;"
           (change)="onImportFromFile($event)">
    <button igxButton [igxToggleAction]="importDropdown" [igxDropDownItemNavigation]="importDropdown">
      インポート
      <igx-icon>arrow_drop_down</igx-icon>
    </button>
    <igx-drop-down #importDropdown (onSelection)="onSelectFileType($event, inputFile)">
      <igx-drop-down-item [value]="'.xlsx'">Excel</igx-drop-down-item>
      <igx-drop-down-item [value]="'.csv'">CSV</igx-drop-down-item>
    </igx-drop-down>

    <button igxButton="icon" [disabled]="!canDelete" (click)="onDelete()">
      <igx-icon>delete</igx-icon>
    </button>
    <button igxButton="icon" [disabled]="!canUndo" (click)="onUndo()">
      <igx-icon>undo</igx-icon>
    </button>
    <button igxButton="icon" [disabled]="!canRedo" (click)="onRedo()">
      <igx-icon>redo</igx-icon>
    </button>
    <button igxButton="icon" [disabled]="!canCommit" (click)="onCommit()">
      <igx-icon>done_all</igx-icon>
    </button>
  </ng-template>

  <igx-column *ngFor="let column of columns"
              [field]="column.field"
              [header]="column.header"
              [dataType]="column.dataType"
              [editable]="true"
              [filterable]="true"
              [groupable]="true"
              [movable]="true"
              [pinned]="false"
              [resizable]="true"
              [sortable]="true"
              [disableHiding]="true">
    <!-- TODO: When we can do in another way, remove these templates.
      https://github.com/IgniteUI/igniteui-angular/issues/4246#issuecomment-471460353
    -->
    <ng-template igxExcelStyleMovingTemplate></ng-template>
    <ng-template igxExcelStyleSortingTemplate></ng-template>
  </igx-column>

</igx-grid>

<igx-snackbar class="snackbar" [isVisible]="isLoadingFile" [autoHide]="false">
  {{ loadingFileName }}
  <span style="margin-left: 1rem;">
      読み込み中
      <svg id="dots" width="30px" height="20px">
        <g fill="#FFFFFF">
          <circle id="dot1" cx="5" cy="18" r="2"></circle>
          <circle id="dot2" cx="15" cy="18" r="2"></circle>
          <circle id="dot3" cx="25" cy="18" r="2"></circle>
        </g>
      </svg>
  </span>
</igx-snackbar>
